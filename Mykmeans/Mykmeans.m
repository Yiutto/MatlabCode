function [Idx,centroid]= Mykmeans(k,data)
%Mykmeansï¼šMykmeansèšç±»ç®—æ³•
%kï¼šæƒ³è¦èšæˆç±»çš„æ•°ç›?
%dataï¼šm*nçš„æ•°æ®é›†

%returnsï¼?
   %centroidï¼škä¸?*nçš„èšç±»è´¨å¿?k*n)
 
%------------------------------------------------------------------------
% æ£?Ÿ¥å˜é‡æ˜¯å¦åˆæ ¼
%------------------------------------------------------------------------

%------------------------------------------------------------------------
% åˆå§‹åŒ–å˜é‡?
%------------------------------------------------------------------------
[m,n]=size(data);
centroid=[];%åˆå§‹åŒ–kä¸ªè´¨å¿?
sum=zeros(1,n);%ç”¨æ¥è¡¨ç¤ºå½“å‰èšç±»ä¸­æ‰€æœ‰æ•°æ®ç‚¹ä¹‹å’Œ
%------------------------------------------------------------------------
% 1.éšæœºä»dataé€‰å–kä¸ªå…ƒç´ ï¼Œä½œä¸ºkä¸ªèšç±»çš„è´¨å¿ƒ
%------------------------------------------------------------------------
for i=1:k
    randnum=floor(m*unifrnd(0,1)+1);
    centroid(i,:)=data(randnum,:); %ç”¨æ¥ä¿å­˜kä¸ªè´¨å¿ƒçš„æ•°ç»„
end

while 1
    %--------------------------------------------------------------------------------
    % 2.åˆ†åˆ«è®¡ç®—å‰©ä¸‹çš„å…ƒç´?1...m)åˆ°kä¸ªèšç±»è´¨å¿ƒçš„æ¬§æ°è·ç¦»ï¼Œå°†è¿™äº›å…ƒç´ è§„åˆ’åˆ°æ¬§æ°è·ç¦»æœ€å°çš„èšç±»
    %--------------------------------------------------------------------------------
    count=zeros(1,k);%è®°å½•èšé›†åˆ°ç›¸å¯¹åº”çš„è´¨å¿ƒçš„æ•°æ®ä¸ªæ•°
    class=[];%åˆå§‹åŒ–classç±»ï¼Œç”¨æ¥ä¿å­˜å¯¹äºdataæ•°æ®é›†è¡Œå‘é‡åœ¨kä¸ªèšç±»çš„åˆ†å¸ƒæƒ…å†µ
    
    for i=1:m
        for j=1:k
            dist(j)=norm(data(i,:)-centroid(j,:));
        end
        %æ‰¾åˆ°æœ?°è·ç¦»
        [mindist,dist_index]=min(dist);%dist_indexè¡¨ç¤ºæ•°æ®ç‚¹è§„åˆ’åˆ°èšç‚¹kçš„ä¸‹æ ?
        count(dist_index)=count(dist_index)+1;%cou
        class(dist_index,count(dist_index))=i;%class(m,n)=iè¡¨ç¤ºç¬¬mèšç±»ä¸­çš„ç¬¬nä¸ªå…ƒç´ æ‰€å¯¹åº”çš„æ˜¯dataæ•°æ®é›†çš„è¡Œå‘é‡çš„ä¸‹æ ‡
    end
    %--------------------------------------------------------------------------------
    % 3.é‡æ–°è®¡ç®—æ–°çš„èšç±»ï¼ˆæ±‚å‡å?ï¼‰çš„è´¨å¿ƒ
    %--------------------------------------------------------------------------------
    for i=1:k
        for j=1:count(i)
            sum=sum+data(class(i,j),:);%å°†å½“å‰èšç±»æ‰€æœ‰æ•°æ®ç‚¹ç›¸åŠ 
        end
        temp_centroid(i,:)=sum/(count(i));%æ±‚å½“å‰èšç±»çš„æ–°è´¨å¿ƒï¼ˆå‡å?ï¼?
        sum(1,:)=0;%ç½?ï¼Œä¸ºäº†æ–¹ä¾¿è®¡ç®—ä¸‹ä¸?¸ªèšç±»çš„è´¨å¿?
    end
    %--------------------------------------------------------------------------------
    % 4.èšç±»è´¨å¿ƒæ˜¯å¦æ”¶æ•›ï¼ˆå³æ–°è´¨å¿ƒå’ŒåŸè´¨å¿ƒç›¸ç­‰ï¼‰ä¹Ÿæ˜¯å®šä¹‰ç»ˆæ­¢æ¡ä»¶
    %--------------------------------------------------------------------------------
    for i=1:k
        centroid_dist(i)=norm(temp_centroid(i,:)-centroid(i,:));
    end
    if max(centroid_dist)<=0
        break;
    else
        for i=1:k
            centroid(i,:)=temp_centroid(i,:);
        end
    end
end

%--------------------------------------------------------------------------------
% 5.è¾“å‡ºèšç±»è´¨å¿ƒå’Œæ¯ä¸ªç‚¹çš„èšç±»èšç±»æ ‡å?
%-------------------------------------------------------------------------------- 
Idx=[];
for i=1:m
    [a1,a2]=find(class==i);
    Idx(i)=a1;
end


%--------------------------------------------------------------------------------
% 5.è¾“å‡ºèšç±»è´¨å¿ƒå’Œåˆ†ç±»å¥½çš„èšç±?
%-------------------------------------------------------------------------------- 
% for i=1:k
%     fprintf('ç¬?dä¸ªèšç±»çš„è´¨å¿ƒï¼?,i);
%     centroid(i,:)
%     fprintf('å½“å‰èšç±»çš„æ•°æ®ï¼š')
%     for j=1:size(class,2)       
%         if(class(i,j)~=0)
%           merge(i).tmp(j,:)= data(class(i,j),:);     
%         end
%     end
%     merge(i).tmp(:,:)
%     fprintf('å½“å‰èšç±»çš„æ•°æ®ä¸ªæ•°ä¸ºï¼?);
%     size((merge(i).tmp(:,:)),1)
%     fprintf('-------------------------------------------------------\n');    
% end



